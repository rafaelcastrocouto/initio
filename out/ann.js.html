<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: ann.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: ann.js</h1>

    


    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>importScripts('protein.js', 'utils.js', 'energy.js');

self.addEventListener('message', function(e) {
  var msg = JSON.parse(e.data);
  Ann(
    msg.seq, 
    msg.ang, 
    msg.l
  );  
}, false);
/**
 * Algorithm inspired in Simulated Annealing
 * @param {String} seq - String with the aminoacid's type sequence.
 * @param {Array} ang - The angle sequence in radians.
 * @param {int} l - The limit of loops (stop criteria).
 */
var Ann = function(seq, ang, l){
  
  var min_p = new Protein({'seq': seq, 'ang': ang});
  
  //ANGLES
  var delta = Math.PI / 4; // 45 deg
  var newAngles = function(a){ 
    var array = [];
    array[0] = a + delta;
    array[1] = a - delta;
    return array;
  }; 
  
  //GLOBALS
  var new_p = min_p, 
      fail_count = 0;
  
  //TESTS
  var test = function(p){ 
    if(p.energy &lt; min_p.energy) {
      min_p = p;      
      fail_count = 0; 
      return p; 
    } else { //fail
      fail_count++;
      return min_p;
    }  
  };

  //loop
  var t = 0;

  for(var t = 0; t &lt; l; ++t){
    
    for(var i = 1; i &lt; min_p.length - 1; ++i){
      var a = new_p.getAngle();
      var na = newAngles(a[i]); 
      
      a[i] = na[0]; 
      new_p = new Protein({ang: a, seq: seq});  
      new_p = test(new_p);     
      
      a[i] = na[1];
      new_p = new Protein({ang: a, seq: seq});
      new_p = test(new_p);    
      
    }
    
    delta *= 0.9;

    if(t%100 == 0) {
      var msg = JSON.stringify({
        data: min_p.energy, 
      });
      self.postMessage(msg);      
    }

  };
  
  var msg = JSON.stringify({
    ang: min_p.getAngle(2), 
    energy: min_p.energy
  });
  self.postMessage(msg);
}


</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Index</a></h2><h3>Classes</h3><ul><li><a href="Amino.html">Amino</a></li><li><a href="Protein.html">Protein</a></li></ul><h3>Global</h3><ul><li><a href="global.html#Ann">Ann</a></li><li><a href="global.html#Ela">Ela</a></li></ul>
</nav>

<br clear="both">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.3.0-alpha5</a> on Wed Mar 19 2014 16:22:27 GMT-0300 (Hora oficial do Brasil)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
